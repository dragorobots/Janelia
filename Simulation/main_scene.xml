<mujoco model="car_in_maze">
  <compiler angle="radian" meshdir="robot_description/meshes/"/>
  <option integrator="RK4" timestep="0.001"/>

  <!-- assets  -->
  <asset>
    <texture type="2d" name="groundplane" builtin="checker"
             rgb1="0.2 0.3 0.4" rgb2="0.1 0.2 0.3" width="512" height="512"/>
    <material name="groundplane" texture="groundplane"
              texrepeat="1 1" texuniform="true"/>
    <mesh name="base_link" file="base_link.STL"/>
    <mesh name="zq_Link"   file="zq_Link.STL"/>
    <mesh name="yq_Link"   file="yq_Link.STL"/>
    <mesh name="yh_Link"   file="yh_Link.STL"/>
    <mesh name="zh_Link"   file="zh_Link.STL"/>
    <mesh name="radar_Link" file="radar_Link.STL"/>
  </asset>

  <!--  world  -->
  <worldbody>
    <light name="top"   pos="0   0 3"    diffuse="0.7 0.7 0.7" specular="0.3 0.3 0.3"/>
    <light name="front" pos="0  -5 3"    dir="0 1 -0.3"    diffuse="0.8 0.8 0.8" specular="0.2 0.2 0.2"/>
    <light name="side"  pos="-5  0 3"    dir="1 0 -0.3"    diffuse="0.8 0.8 0.8" specular="0.2 0.2 0.2"/>
    <!-- navigation targets -->
    <site name="pylon_A" pos="3 2 0" size="0.06 0.30" rgba="1 0 0 0.4" type="cylinder"/>
    <site name="pylon_B" pos= "3  1.0 0" size="0.06 0.30" rgba="0 1 0 0.4" type="cylinder"/>
    <site name="pylon_C" pos=" .5 2 0" size="0.06 0.30" rgba="0 0 1 0.4" type="cylinder"/>
    <site name="pylon_D" pos=" .5 1.0 0" size="0.06 0.30" rgba="1 1 0 0.4" type="cylinder"/>



    <camera name="top_down" mode="track" target="base_link"
        pos="0.5 5.25 .1" xyaxes="1 0 0 0 1 0"/>

    <geom name="floor" size="5 7 0.1" type="plane" material="groundplane"/>
<!-- Maze walls autogenerated from your coordinates -->
    <geom name="wall_seg_0" type="box" pos="0.040 5.165 0.2" size="0.050 0.615 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_1" type="box" pos="0.685 4.550 0.2" size="0.645 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_2" type="box" pos="0.900 3.330 0.2" size="0.050 1.220 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_3" type="box" pos="0.470 2.680 0.2" size="0.430 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_4" type="box" pos="0.040 1.360 0.2" size="0.050 1.320 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_5" type="box" pos="1.745 0.040 0.2" size="1.705 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_6" type="box" pos="3.470 1.360 0.2" size="0.050 1.320 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_7" type="box" pos="3.060 2.680 0.2" size="0.410 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_8" type="box" pos="2.680 3.280 0.2" size="0.050 1.280 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_9" type="box" pos="2.340 4.560 0.2" size="0.340 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_10" type="box" pos="2.000 5.175 0.2" size="0.050 0.615 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_11" type="box" pos="1.030 5.790 0.2" size="0.970 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_12" type="box" pos="0.460 1.340 0.2" size="0.440 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_13" type="box" pos="0.900 1.000 0.2" size="0.050 0.330 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_14" type="box" pos="3.030 1.350 0.2" size="0.410 0.050 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_15" type="box" pos="2.620 1.015 0.2" size="0.050 0.335 0.2" rgba="0.1 0.1 0.1 1"/>
    <geom name="wall_seg_16" type="box" pos="1.720 1.930 0.2" size="0.050 1.870 0.2" rgba="0.1 0.1 0.1 1"/>

  <!-- lobby entrance (START) is open at bottom-center -->

  <!-- ─────── Robot body: spawn in the lobby ─────── -->
  <body name="base_link" pos="0.5 5.25 .1">
    <joint type="free"/>
    <geom type="mesh" mesh="base_link" rgba="1 1 1 1" contype="0" conaffinity="0"/>
      <geom type="box" size="0.05 0.07 0.02" pos="0 0 -0.01" group="3"/>
      <inertial pos="0 0 0" mass="1.5" diaginertia="0.0027 0.0015 0.0037"/>

      <!--  LiDAR / radar block (raised)  -->
      <body name="radar_link" pos="0 0 0.09">
        <geom type="mesh" mesh="radar_Link" rgba="0.1 0.1 0.1 1" contype="0" conaffinity="0"/>
        <geom type="cylinder" size="0.025 0.02" rgba="0.1 0.1 0.1 1" group="3"/>
        <inertial pos="0 0 0" mass="0.038" diaginertia="8.81e-6 1.44e-05 2.24e-05"/>

        <!-- horizontal beams: 90° about +Y then yawed -->
        <site name="lidar_0"   pos="0 0 0" quat="0.7071  0      0.7071 0" size="0.005" type="sphere"/>
        <site name="lidar_45"  pos="0 0 0" quat="0.7071 -0.5    0.5    0" size="0.005" type="sphere"/>
        <site name="lidar_90"  pos="0 0 0" quat="0.7071 -0.7071 0      0" size="0.005" type="sphere"/>
        <site name="lidar_135" pos="0 0 0" quat="0.7071 -0.5   -0.5    0" size="0.005" type="sphere"/>
        <site name="lidar_180" pos="0 0 0" quat="0.7071  0     -0.7071 0" size="0.005" type="sphere"/>
        <site name="lidar_225" pos="0 0 0" quat="0.7071  0.5   -0.5    0" size="0.005" type="sphere"/>
        <site name="lidar_270" pos="0 0 0" quat="0.7071  0.7071 0      0" size="0.005" type="sphere"/>
        <site name="lidar_315" pos="0 0 0" quat="0.7071  0.5    0.5    0" size="0.005" type="sphere"/>
      </body>

      <!-- IMU block (unchanged) -->
      <body name="imu_link" pos="-0.002 -0.003 0.031">
        <geom size="0.015 0.01 0.005" type="box" rgba="0.2 0.8 0.2 1"/>
        <inertial pos="0 0 0" mass="0.013" diaginertia="2.09e-6 4.73e-6 6.79e-06"/>
      </body>

      <body name="zq_Link" pos="0.0455 0.0675 -0.02125">
        <inertial pos="0 0 0" mass="0.07" diaginertia="2.66e-6 4.68e-6 2.66e-06"/>
        <joint name="zq_Joint" type="hinge" axis="0 -1 0" damping="0.0075"/>
        <geom type="mesh" mesh="zq_Link" rgba="0.6 0.6 0.6 1" contype="0" conaffinity="0"/>
        <geom name="zq_collision" type="cylinder" size="0.03 0.02" quat="0.707 0.707 0 0" solimp="0.9 0.95 0.001" solref="0.02 1"/>
      </body>
      <body name="yq_Link" pos="0.0455 -0.0675 -0.02125">
        <inertial pos="0 0 0" mass="0.07" diaginertia="2.66e-6 4.68e-6 2.66e-06"/>
        <joint name="yq_Joint" type="hinge" axis="0 1 0" damping="0.0075"/>
        <geom type="mesh" mesh="yq_Link" rgba="0.6 0.6 0.6 1" contype="0" conaffinity="0"/>
        <geom name="yq_collision" type="cylinder" size="0.03 0.02" quat="0.707 0.707 0 0" solimp="0.9 0.95 0.001" solref="0.02 1"/>
      </body>
      <body name="yh_Link" pos="-0.0495 -0.0675 -0.02125">
        <inertial pos="0 0 0" mass="0.07" diaginertia="2.66e-6 4.68e-6 2.66e-06"/>
        <joint name="yh_Joint" type="hinge" axis="0 1 0" damping="0.0075"/>
        <geom type="mesh" mesh="yh_Link" rgba="0.6 0.6 0.6 1" contype="0" conaffinity="0"/>
        <geom name="yh_collision" type="cylinder" size="0.03 0.02" quat="0.707 0.707 0 0" solimp="0.9 0.95 0.001" solref="0.02 1"/>
      </body>
      <body name="zh_Link" pos="-0.0495 0.0675 -0.02125">
        <inertial pos="0 0 0" mass="0.07" diaginertia="2.66e-6 4.68e-6 2.66e-06"/>
        <joint name="zh_Joint" type="hinge" axis="0 -1 0" damping="0.0075"/>
        <geom type="mesh" mesh="zh_Link" rgba="0.6 0.6 0.6 1" contype="0" conaffinity="0"/>
        <geom name="zh_collision" type="cylinder" size="0.03 0.02" quat="0.707 0.707 0 0" solimp="0.9 0.95 0.001" solref="0.02 1"/>
      </body>
      
      <body name="camera_yaw_link" pos="0.08 0 0.045">
        <inertial pos="0 0 0" mass="0.05" diaginertia="1e-4 1e-4 1e-4"/>
        <joint name="camera_yaw_joint" type="hinge" axis="0 0 1"
               range="-0.785 0.785" damping="0.1"/>
        <geom type="box" size="0.01 0.01 0.01" rgba="0.8 0.2 0.2 1"/>
        <body name="camera_pitch_link">
          <inertial pos="0 0 0" mass="0.05" diaginertia="1e-4 1e-4 1e-4"/>
          <joint name="camera_pitch_joint" type="hinge" axis="0 1 0"
                 range="-0.785 0.785" damping="0.1"/>
          <geom type="cylinder" size="0.01 0.015" pos="0.015 0 0"
                quat="0.707 0 0.707 0" rgba="0.2 0.2 0.8 1"/>
          <camera name="front_camera" mode="fixed" fovy="60"/>
        </body>
      </body>
    </body>
  </worldbody>

  <actuator>
    <motor name="front_left_motor"  joint="zq_Joint"  ctrllimited="true" ctrlrange="-1.0 1.0" forcerange="-0.1 0.1"/>
    <motor name="front_right_motor" joint="yq_Joint"  ctrllimited="true" ctrlrange="-1.0 1.0" forcerange="-0.1 0.1"/>
    <motor name="back_left_motor"   joint="zh_Joint"  ctrllimited="true" ctrlrange="-1.0 1.0" forcerange="-0.1 0.1"/>
    <motor name="back_right_motor"  joint="yh_Joint"  ctrllimited="true" ctrlrange="-1.0 1.0" forcerange="-0.1 0.1"/>
    <position name="camera_yaw_servo" joint="camera_yaw_joint" kp="0.2" kv="0.005"/>
    <position name="camera_pitch_servo" joint="camera_pitch_joint" kp="0.2" kv="0.005"/>
  </actuator>
  <sensor>
    <rangefinder name="lidar_0" site="lidar_0"/><rangefinder name="lidar_45" site="lidar_45"/><rangefinder name="lidar_90" site="lidar_90"/>
    <rangefinder name="lidar_135" site="lidar_135"/><rangefinder name="lidar_180" site="lidar_180"/><rangefinder name="lidar_225" site="lidar_225"/>
    <rangefinder name="lidar_270" site="lidar_270"/><rangefinder name="lidar_315" site="lidar_315"/>
    <framepos name="position" objtype="body" objname="imu_link"/>
    <framequat name="orientation" objtype="body" objname="imu_link"/>
    <framelinvel name="linear_velocity" objtype="body" objname="imu_link"/>
    <frameangvel name="angular_velocity" objtype="body" objname="imu_link"/>
  </sensor>
</mujoco>